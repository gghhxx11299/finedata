<!DOCTYPE html>
<html lang="en">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finedatas Ethiopia - Weather & Crop Recommendations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@500;600;700;800&display=swap" rel="stylesheet">
    <!-- PDF Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --bg-primary: #0D1117;
            --bg-secondary: #161B22;
            --bg-card: #161B22;
            --primary-accent: #58A6FF;
            --secondary-accent: #FF7B72;
            --text-primary: #C9D1D9;
            --text-secondary: #8B949E;
            --border-color: #30363D;
            --success-color: #3FB950;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            --shadow-hover: 0 8px 20px rgba(0, 0, 0, 0.7);
        }
        * {margin:0;padding:0;box-sizing:border-box;}
        body {font-family:'Inter','Segoe UI',sans-serif;line-height:1.6;color:var(--text-primary);background-color:var(--bg-primary);}
        .container {width:90%;max-width:1200px;margin:0 auto;padding:0 15px;}
        header {background-color:var(--bg-secondary);box-shadow:var(--shadow);position:sticky;top:0;z-index:100;border-bottom:1px solid var(--border-color);}
        nav {display:flex;justify-content:space-between;align-items:center;padding:1rem 0;}
        .logo {display:flex;align-items:center;}
        .logo img {height:40px;margin-right:10px;border-radius:4px;}
        .logo h1 {color:var(--primary-accent);font-size:1.5rem;font-weight:700;font-family:'Montserrat',sans-serif;}
        .nav-links {display:flex;list-style:none;}
        .nav-links li {margin-left:1.5rem;}
        .nav-links a {text-decoration:none;color:var(--text-primary);font-weight:500;transition:color 0.3s;padding:0.5rem 0;position:relative;}
        .nav-links a:not(.btn):after {content:'';position:absolute;width:0;height:2px;bottom:0;left:0;background-color:var(--primary-accent);transition:width 0.3s;}
        .nav-links a:hover:after {width:100%;}
        .nav-links a:hover {color:var(--primary-accent);}
        .mobile-menu-btn {display:none;background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--primary-accent);}
        .hero {background:linear-gradient(rgba(13,17,23,0.85),rgba(13,17,23,0.95)),url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');color:var(--text-primary);padding:5rem 0;text-align:center;margin-bottom:3rem;border-bottom:1px solid var(--border-color);}
        .hero h2 {font-size:2.8rem;margin-bottom:1rem;font-family:'Montserrat',sans-serif;font-weight:700;color:var(--text-primary);}
        .hero p {font-size:1.2rem;max-width:800px;margin:0 auto 2rem;color:var(--text-secondary);}
        .btn {display:inline-block;background-color:var(--primary-accent);color:var(--bg-primary);padding:0.8rem 1.5rem;border-radius:6px;text-decoration:none;font-weight:600;transition:all 0.3s ease;border:none;cursor:pointer;}
        .btn:hover {background-color:var(--secondary-accent);color:var(--text-primary);box-shadow:0 0 10px var(--secondary-accent),0 0 20px rgba(255,123,114,0.3);transform:translateY(-2px);}
        .weather-section, .soil-section, .recommendation-section {padding:3rem 0;}
        .section-title {text-align:center;color:var(--primary-accent);margin-bottom:3rem;font-size:2.2rem;font-family:'Montserrat',sans-serif;font-weight:700;}
        .city-selector {display:flex;justify-content:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem;}
        .city-btn {background-color:var(--bg-card);color:var(--text-primary);border:1px solid var(--border-color);padding:0.5rem 1rem;border-radius:6px;cursor:pointer;transition:all 0.3s;}
        .city-btn:hover, .city-btn.active {background-color:var(--primary-accent);color:var(--bg-primary);}
        .weather-container {display:grid;grid-template-columns:1fr 2fr;gap:2rem;margin-bottom:3rem;}
        @media(max-width:768px){
            .weather-container{grid-template-columns:1fr;}
            .nav-links{display:none;flex-direction:column;position:absolute;top:100%;left:0;width:100%;background-color:var(--bg-secondary);box-shadow:var(--shadow);padding:1rem 0;border-top:1px solid var(--border-color);}
            .nav-links.active{display:flex;}
            .nav-links li{margin:0.5rem 1.5rem;}
            .mobile-menu-btn{display:block;}
            .hero h2{font-size:2rem;}
            .forecast-grid{grid-template-columns:repeat(auto-fill,minmax(120px,1fr));}
            .soil-grid, .calendar-grid {grid-template-columns: 1fr;}
            .recommendation-container {grid-template-columns: 1fr;}
        }
        .current-weather, .forecast, .soil-card, .crop-card, .alerts-list, .calendar-grid {
            background-color:var(--bg-card);
            border-radius:12px;
            padding:2rem;
            box-shadow:var(--shadow);
            border:1px solid var(--border-color);
        }
        .current-weather h3, .forecast h3, .soil-card h3, .crop-card h3, .alerts-list h3, .calendar-grid h3 {
            color:var(--primary-accent);
            margin-bottom:1rem;
            font-family:'Montserrat',sans-serif;
            border-bottom:1px solid var(--border-color);
            padding-bottom:0.5rem;
        }
        .weather-detail {display:flex;justify-content:space-between;margin-bottom:0.8rem;padding-bottom:0.8rem;border-bottom:1px solid var(--border-color);}
        .weather-detail:last-child {border-bottom:none;}
        .weather-detail .label {color:var(--text-secondary);}
        .weather-detail .value {color:var(--text-primary);font-weight:600;}
        .forecast-grid {display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1rem;}
        .forecast-day {background-color:rgba(255,255,255,0.05);border-radius:8px;padding:1rem;text-align:center;border:1px solid var(--border-color);transition:transform 0.3s;}
        .forecast-day:hover {transform:translateY(-3px);border-color:var(--primary-accent);}
        .forecast-date {font-weight:600;margin-bottom:0.5rem;color:var(--primary-accent);}
        .forecast-temp {display:flex;justify-content:space-around;margin:0.5rem 0;}
        .temp-min, .temp-max {display:flex;flex-direction:column;}
        .temp-min .label, .temp-max .label {font-size:0.8rem;color:var(--text-secondary);}
        .temp-min .value {color:#58A6FF;}
        .temp-max .value {color:#FF7B72;}
        .forecast-weather {margin:0.5rem 0;font-size:0.9rem;}
        .forecast-precipitation, .forecast-wind {font-size:0.8rem;color:var(--text-secondary);}
        footer {background-color:var(--bg-secondary);color:var(--text-primary);padding:3rem 0 1.5rem;border-top:1px solid var(--border-color);}
        .footer-content {display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:2rem;margin-bottom:2rem;}
        .footer-section h3 {margin-bottom:1rem;font-size:1.2rem;color:var(--primary-accent);font-family:'Montserrat',sans-serif;}
        .footer-section p, .footer-section a {margin-bottom:0.5rem;color:var(--text-secondary);}
        .footer-section a {display:block;text-decoration:none;transition:color 0.3s;}
        .footer-section a:hover {color:var(--primary-accent);}
        .social-links {display:flex;gap:1rem;margin-top:1rem;}
        .social-links a {display:inline-block;color:var(--text-primary);background-color:rgba(255,255,255,0.1);width:40px;height:40px;border-radius:50%;text-align:center;line-height:40px;transition:all 0.3s;}
        .social-links a:hover {background-color:var(--primary-accent);color:var(--bg-primary);transform:translateY(-3px);}
        .footer-bottom {text-align:center;padding-top:1.5rem;border-top:1px solid var(--border-color);color:var(--text-secondary);}
        .loading {text-align:center;padding:2rem;color:var(--text-secondary);}
        .error {text-align:center;padding:2rem;color:var(--secondary-accent);}

        /* Soil Section Styles */
        .soil-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 2rem;
        }

        .soil-card h4 {
            color: var(--primary-accent);
            margin-bottom: 12px;
            font-size: 1.3rem;
        }

        .soil-detail {
            margin-bottom: 10px;
            display: flex;
        }

        .soil-detail .label {
            color: var(--text-secondary);
            min-width: 120px;
            font-weight: 500;
        }

        .soil-detail .value {
            color: var(--text-primary);
        }

        /* Crop Recommendation Section */
        .recommendation-section {
            background-color: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
        }

        .recommendation-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .crop-card h4 {
            color: var(--primary-accent);
            margin-bottom: 12px;
            font-size: 1.4rem;
        }

        .crop-detail {
            display: flex;
            margin-bottom: 8px;
        }

        .crop-detail .label {
            color: var(--text-secondary);
            min-width: 140px;
            font-weight: 500;
        }

        .crop-detail .value {
            color: var(--text-primary);
            font-weight: 600;
        }

        .alerts-list .alert-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .alerts-list .alert-item:last-child {
            border-bottom: none;
        }

        .alerts-list i {
            color: var(--success-color);
            font-size: 1.2rem;
            min-width: 24px;
            margin-top: 4px;
        }

        .seasonal-calendar {
            margin-top: 2rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 1rem;
        }

        .calendar-item {
            background: rgba(88, 166, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .calendar-item h5 {
            color: var(--primary-accent);
            margin-bottom: 6px;
            font-size: 1.1rem;
        }

        .calendar-item .window {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Export Button */
        .export-section {
            text-align: center;
            margin: 2rem 0;
        }

        .btn-export {
            background-color: var(--success-color);
            color: var(--bg-primary);
            padding: 0.7rem 1.4rem;
            border-radius: 6px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-export:hover {
            background-color: #2ea043;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(63, 185, 80, 0.4);
        }

        .btn-export:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Hidden export content for PDF */
        #pdf-content {
            position: fixed;
            left: -9999px;
            top: -9999px;
            width: 800px;
            background: white;
            color: black;
            padding: 30px;
            font-family: 'Inter', sans-serif;
        }

        #pdf-content h1, #pdf-content h2, #pdf-content h3 {
            color: #0d1117;
        }

        #pdf-content .weather-detail, #pdf-content .crop-detail {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
        }

        #pdf-content .section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <img src="https://media.licdn.com/dms/image/v2/D4E22AQGXMc2SntbjBA/feedshare-shrink_800/B4EZk6G01vHoAk-/0/1757616497506?e=1760572800&v=beta&t=8j9qaS3FBcRpEqrjVREfn2y6DriWCK_IxbIG0HmwhRg" alt="Finedata Logo">
                    <h1>Finedatas</h1>
                </div>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="economic.html">Economic</a></li>
                    <li><a href="demographic.html">Demographic</a></li>
                    <li><a href="agricultural.html">Agricultural</a></li>
                    <li><a href="ai-chat.html">AI Chat</a></li>
                    <li><a href="news.html">News</a></li>
                    <li><a href="exchange.html">Exchange Rates</a></li>
                    <li><a href="pdf.html">PDF Resources</a></li>
                    <li><a href="weather.html" class="active">For Farmers</a></li>
                    <li><a href="insights.html">Get Forecasts</a></li>
                    <li><a href="support.html">Support</a></li>
                    <li><a href="donate.html" class="btn">Donate</a></li>
                </ul>
                <button class="mobile-menu-btn"><i class="fas fa-bars"></i></button>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <h2>Ethiopia Weather & Crop Recommendations</h2>
            <p>Access real-time weather, soil data, and smart planting advice to maximize your harvest</p>
            <div style="margin-top: 1.5rem;">
                <a href="#weather-data" class="btn" style="margin-right: 1rem;">View Weather Data</a>
                <button id="exportBtnHero" class="btn-export">
                    <i class="fas fa-file-pdf"></i> Export Report (PDF)
                </button>
            </div>
        </div>
    </section>

    <section id="weather-data" class="weather-section">
        <div class="container">
            <h2 class="section-title">Weather Information</h2>
            <div class="city-selector">
                <button class="city-btn active" data-city="Addis Ababa">Addis Ababa</button>
                <button class="city-btn" data-city="Mekelle">Mekelle</button>
                <button class="city-btn" data-city="Bahir Dar">Bahir Dar</button>
                <button class="city-btn" data-city="Hawassa">Hawassa</button>
                <button class="city-btn" data-city="Dire Dawa">Dire Dawa</button>
                <button class="city-btn" data-city="Jijiga">Jijiga</button>
                <button class="city-btn" data-city="Gambela">Gambela</button>
                <button class="city-btn" data-city="Asosa">Asosa</button>
                <button class="city-btn" data-city="Semera">Semera</button>
                <button class="city-btn" data-city="Jimma">Jimma</button>
                <button class="city-btn" data-city="Nekemte">Nekemte</button>
                <button class="city-btn" data-city="Bale Robe">Bale Robe</button>
                <button class="city-btn" data-city="Shashemene">Shashemene</button>
                <button class="city-btn" data-city="Dilla">Dilla</button>
                <button class="city-btn" data-city="Bonga">Bonga</button>
                <button class="city-btn" data-city="Arba Minch">Arba Minch</button>
                <button class="city-btn" data-city="Hosaena">Hosaena</button>
                <button class="city-btn" data-city="Debre Markos">Debre Markos</button>
                <button class="city-btn" data-city="Debre Birhan">Debre Birhan</button>
                <button class="city-btn" data-city="Metu">Metu</button>
                <button class="city-btn" data-city="Adigrat">Adigrat</button>
                <button class="city-btn" data-city="Goba">Goba</button>
            </div>

            <div class="weather-container">
                <div class="current-weather">
                    <h3>Current Weather</h3>
                    <div class="weather-detail"><span class="label">Temperature</span><span class="value" id="temp">--</span></div>
                    <div class="weather-detail"><span class="label">Humidity</span><span class="value" id="humidity">--</span></div>
                    <div class="weather-detail"><span class="label">Conditions</span><span class="value" id="conditions">--</span></div>
                    <div class="weather-detail"><span class="label">Wind Speed</span><span class="value" id="wind">--</span></div>
                    <div class="weather-detail"><span class="label">Last Updated</span><span class="value" id="updated">--</span></div>
                </div>

                <div class="forecast">
                    <h3>14-Day Forecast</h3>
                    <div class="forecast-grid" id="forecast-container">
                        <div class="loading">Loading weather data...</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Soil & Crop Guidance Section -->
    <section class="soil-section">
        <div class="container">
            <h2 class="section-title">Soil Requirements for Key Crops</h2>
            <p style="text-align:center; color:var(--text-secondary); margin-bottom:2rem;">
                Based on CIMMYT, FAO, and Ethiopian Institute of Agricultural Research (EIAR) recommendations
            </p>
            <div class="soil-grid">
                <!-- Maize -->
                <div class="soil-card">
                    <h4>Maize</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Loamy, well-drained</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">5.5 – 7.0</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">≥ 2%</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">N, P, K</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Avoid waterlogged soils; drought-tolerant varieties available</span></div>
                </div>

                <!-- Teff -->
                <div class="soil-card">
                    <h4>Teff</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Clay-loam, heavy soils</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">5.0 – 7.5</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">Moderate</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">N, P</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Thrives in water-retentive soils; shallow root system</span></div>
                </div>

                <!-- Wheat -->
                <div class="soil-card">
                    <h4>Wheat</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Loam to clay-loam</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">6.0 – 7.5</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">≥ 1.5%</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">N, P, S, Zn</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Sensitive to waterlogging; requires good drainage</span></div>
                </div>

                <!-- Sorghum -->
                <div class="soil-card">
                    <h4>Sorghum</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Sandy loam to clay</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">5.0 – 8.5</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">Low to moderate</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">N, P</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Highly drought-tolerant; grows in marginal soils</span></div>
                </div>

                <!-- Coffee (Arabica) -->
                <div class="soil-card">
                    <h4>Coffee (Arabica)</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Volcanic, well-drained loam</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">5.5 – 6.5</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">High (≥ 3%)</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">N, K, Mg, B</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Requires shade; sensitive to water stress</span></div>
                </div>

                <!-- Enset -->
                <div class="soil-card">
                    <h4>Enset</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Deep, moist, fertile loam</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">5.5 – 6.5</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">Very high</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">K, Ca, Mg</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Needs consistent moisture; traditional composting essential</span></div>
                </div>

                <!-- Barley -->
                <div class="soil-card">
                    <h4>Barley</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Loam, tolerates lighter soils</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">6.0 – 7.5</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">≥ 1.2%</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">N, P</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Cold-tolerant; suitable for highlands</span></div>
                </div>

                <!-- Chickpea -->
                <div class="soil-card">
                    <h4>Chickpea</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Sandy loam, well-drained</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">6.0 – 9.0</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">Low to moderate</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">P, S, Zn</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Fixes nitrogen; avoid acidic or waterlogged soils</span></div>
                </div>

                <!-- Sesame -->
                <div class="soil-card">
                    <h4>Sesame</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Sandy loam to loam</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">5.5 – 8.0</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">Moderate</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">N, P, K</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Drought-tolerant; sensitive to waterlogging</span></div>
                </div>

                <!-- Potato -->
                <div class="soil-card">
                    <h4>Potato</h4>
                    <div class="soil-detail"><span class="label">Soil Type:</span><span class="value">Sandy loam, loose, well-drained</span></div>
                    <div class="soil-detail"><span class="label">pH Range:</span><span class="value">5.0 – 6.5</span></div>
                    <div class="soil-detail"><span class="label">Organic Matter:</span><span class="value">High</span></div>
                    <div class="soil-detail"><span class="label">Key Nutrients:</span><span class="value">K, P, Mg</span></div>
                    <div class="soil-detail"><span class="label">Notes:</span><span class="value">Acidic soils reduce scab; rotate crops</span></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Crop Recommendation Section -->
    <section class="recommendation-section">
        <div class="container">
            <h2 class="section-title">Smart Crop Recommendations</h2>
            <p style="text-align:center; color:var(--text-secondary); margin-bottom:2rem;">
                Personalized planting advice based on current weather, soil, and seasonal cycles in your region
            </p>

            <div class="export-section">
                <button id="exportBtnRec" class="btn-export">
                    <i class="fas fa-file-pdf"></i> Export This Report as PDF
                </button>
            </div>

            <div class="recommendation-container">
                <div class="current-recommendation">
                    <h3>Recommended Crop to Plant Now</h3>
                    <div class="crop-card" id="recommended-crop">
                        <div class="loading">Analyzing conditions for <span id="rec-city">Addis Ababa</span>...</div>
                    </div>
                </div>

                <div class="harvest-alerts">
                    <h3>Upcoming Harvest Alerts</h3>
                    <div class="alerts-list" id="harvest-alerts">
                        <div class="alert-item">
                            <i class="fas fa-seedling"></i>
                            <div>
                                <strong>Maize</strong> planted in early August will be ready to harvest in <strong>2 weeks</strong>.
                            </div>
                        </div>
                        <div class="alert-item">
                            <i class="fas fa-wheat-alt"></i>
                            <div>
                                <strong>Teff</strong> harvest window opens next week in highland zones.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="seasonal-calendar">
                <h3>Regional Planting Calendar</h3>
                <p style="text-align:center; color:var(--text-secondary); margin:1rem 0;">
                    Optimal planting windows for <span id="calendar-city">Addis Ababa</span>
                </p>
                <div class="calendar-grid" id="planting-calendar">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>
    </section>

    <!-- Hidden div for PDF generation -->
    <div id="pdf-content">
        <h1>Finedatas Ethiopia</h1>
        <h2>Farming Advisory Report</h2>
        <p id="pdf-city">Addis Ababa</p>
        <p id="pdf-date">Generated on: <span id="pdf-timestamp"></span></p>

        <div class="section">
            <h3>Current Weather</h3>
            <div class="weather-detail"><span>Temperature:</span><span id="pdf-temp">--</span></div>
            <div class="weather-detail"><span>Humidity:</span><span id="pdf-humidity">--</span></div>
            <div class="weather-detail"><span>Conditions:</span><span id="pdf-conditions">--</span></div>
            <div class="weather-detail"><span>Wind Speed:</span><span id="pdf-wind">--</span></div>
        </div>

        <div class="section">
            <h3>Recommended Crop</h3>
            <div class="crop-detail"><span>Crop:</span><span id="pdf-crop">--</span></div>
            <div class="crop-detail"><span>Why:</span><span id="pdf-reason">--</span></div>
            <div class="crop-detail"><span>Planting Window:</span><span id="pdf-window">--</span></div>
        </div>

        <p style="margin-top: 30px; font-size: 0.9em; color: #666;">
            Powered by Finedatas Ethiopia • Data based on EIAR, FAO, and real-time weather
        </p>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>About Finedatas</h3>
                    <p>Ethiopia's premier data hub providing comprehensive economic, demographic, and agricultural statistics.</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <a href="economic.html">Economic Data</a>
                    <a href="demographic.html">Demographic Data</a>
                    <a href="agricultural.html">Agricultural Data</a> 
                    <a href="exchange.html">Exchange Rates</a>
                </div>
                <div class="footer-section">
                    <h3>Contact Us</h3>
                    <p><i class="fas fa-envelope"></i> gabrielmulugeta1@gmail.com</p>
                    <p><i class="fas fa-phone"></i> +251991168917</p>
                    <p><i class="fas fa-map-marker-alt"></i> Addis Ababa, Ethiopia</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Finedatas. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Make jsPDF available globally
        const { jsPDF } = window.jspdf;

        // Sample data to use if the JSON file is not found
        const sampleData = {
            "metadata": {
                "generated_at": "2025-09-17T10:34:19.412939",
                "locations_count": 22,
                "failed_locations": []
            },
            "weather_data": [
                {
                    "location": "Addis Ababa",
                    "timestamp": "2025-09-17T10:33:40.923561",
                    "current": {
                        "temperature": 18.4,
                        "humidity": 73,
                        "weather": "Partly cloudy",
                        "wind_speed": 3.6,
                        "timestamp": "2025-09-17 10:30"
                    },
                    "forecast": [
                        {
                            "date": "2025-09-17",
                            "temp_min": 10.4,
                            "temp_max": 20.3,
                            "weather": "Moderate rain",
                            "precipitation": 95,
                            "wind_speed": 8.6
                        },
                        {
                            "date": "2025-09-18",
                            "temp_min": 11.3,
                            "temp_max": 19.8,
                            "weather": "Moderate rain",
                            "precipitation": 87,
                            "wind_speed": 10.4
                        },
                        {
                            "date": "2025-09-19",
                            "temp_min": 11.3,
                            "temp_max": 18.6,
                            "weather": "Moderate rain",
                            "precipitation": 85,
                            "wind_speed": 10.1
                        },
                        {
                            "date": "2025-09-20",
                            "temp_min": 12.6,
                            "temp_max": 17.4,
                            "weather": "Moderate rain",
                            "precipitation": 89,
                            "wind_speed": 8.6
                        },
                        {
                            "date": "2025-09-21",
                            "temp_min": 12.6,
                            "temp_max": 19.6,
                            "weather": "Heavy rain",
                            "precipitation": 89,
                            "wind_speed": 7.2
                        },
                        {
                            "date": "2025-09-22",
                            "temp_min": 11.8,
                            "temp_max": 17.6,
                            "weather": "Patchy rain nearby",
                            "precipitation": 85,
                            "wind_speed": 7.6
                        },
                        {
                            "date": "2025-09-23",
                            "temp_min": 11.0,
                            "temp_max": 18.5,
                            "weather": "Patchy rain nearby",
                            "precipitation": 82,
                            "wind_speed": 16.9
                        }
                    ]
                },
                {
                    "location": "Mekelle",
                    "timestamp": "2025-09-17T10:33:42.428994",
                    "current": {
                        "temperature": 18.3,
                        "humidity": 61,
                        "weather": "Patchy rain nearby",
                        "wind_speed": 4.0,
                        "timestamp": "2025-09-17 10:30"
                    },
                    "forecast": [
                        {
                            "date": "2025-09-17",
                            "temp_min": 16.4,
                            "temp_max": 21.9,
                            "weather": "Moderate rain",
                            "precipitation": 89,
                            "wind_speed": 13.0
                        },
                        {
                            "date": "2025-09-18",
                            "temp_min": 15.9,
                            "temp_max": 22.1,
                            "weather": "Patchy rain nearby",
                            "precipitation": 89,
                            "wind_speed": 15.1
                        },
                        {
                            "date": "2025-09-19",
                            "temp_min": 15.8,
                            "temp_max": 22.6,
                            "weather": "Patchy rain nearby",
                            "precipitation": 87,
                            "wind_speed": 14.0
                        },
                        {
                            "date": "2025-09-20",
                            "temp_min": 15.8,
                            "temp_max": 22.9,
                            "weather": "Patchy rain nearby",
                            "precipitation": 85,
                            "wind_speed": 14.0
                        },
                        {
                            "date": "2025-09-21",
                            "temp_min": 15.8,
                            "temp_max": 22.8,
                            "weather": "Patchy rain nearby",
                            "precipitation": 87,
                            "wind_speed": 13.3
                        },
                        {
                            "date": "2025-09-22",
                            "temp_min": 15.9,
                            "temp_max": 22.5,
                            "weather": "Patchy rain nearby",
                            "precipitation": 87,
                            "wind_speed": 13.7
                        },
                        {
                            "date": "2025-09-23",
                            "temp_min": 15.8,
                            "temp_max": 22.5,
                            "weather": "Patchy rain nearby",
                            "precipitation": 85,
                            "wind_speed": 13.3
                        }
                    ]
                },
                {
                    "location": "Jimma",
                    "timestamp": "2025-09-17T10:33:42.428994",
                    "current": {
                        "temperature": 22.1,
                        "humidity": 85,
                        "weather": "Heavy rain",
                        "wind_speed": 5.2,
                        "timestamp": "2025-09-17 10:30"
                    },
                    "forecast": []
                },
                {
                    "location": "Gambela",
                    "timestamp": "2025-09-17T10:33:42.428994",
                    "current": {
                        "temperature": 26.3,
                        "humidity": 88,
                        "weather": "Heavy rain",
                        "wind_speed": 4.8,
                        "timestamp": "2025-09-17 10:30"
                    },
                    "forecast": []
                }
            ]
        };

        async function fetchWeatherData() {
            try {
                const response = await fetch('data.json');
                if (!response.ok) {
                    throw new Error('Failed to fetch data.json, using sample data');
                }
                return await response.json();
            } catch (err) {
                console.error('Failed to load data.json, using sample data:', err);
                return sampleData;
            }
        }

        function updateWeatherDisplay(data, city) {
            const cityData = data.weather_data.find(item => item.location === city);
            
            if (!cityData) {
                document.getElementById('forecast-container').innerHTML = 
                    '<div class="error">Weather data not available for ' + city + '</div>';
                return;
            }

            document.getElementById('temp').textContent = cityData.current.temperature + '°C';
            document.getElementById('humidity').textContent = cityData.current.humidity + '%';
            document.getElementById('conditions').textContent = cityData.current.weather;
            document.getElementById('wind').textContent = cityData.current.wind_speed + ' km/h';
            document.getElementById('updated').textContent = cityData.current.timestamp;

            const forecastContainer = document.getElementById('forecast-container');
            forecastContainer.innerHTML = '';
            
            cityData.forecast.forEach(day => {
                const forecastDay = document.createElement('div');
                forecastDay.className = 'forecast-day';
                forecastDay.innerHTML = `
                    <div class="forecast-date">${formatDate(day.date)}</div>
                    <div class="forecast-temp">
                        <div class="temp-min"><span class="label">Min</span><span class="value">${day.temp_min}°C</span></div>
                        <div class="temp-max"><span class="label">Max</span><span class="value">${day.temp_max}°C</span></div>
                    </div>
                    <div class="forecast-weather">${day.weather}</div>
                    <div class="forecast-precipitation">Precip: ${day.precipitation}%</div>
                    <div class="forecast-wind">Wind: ${day.wind_speed} km/h</div>
                `;
                forecastContainer.appendChild(forecastDay);
            });
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
        }

        // Crop recommendation logic
        function getRecommendation(city, weatherData) {
            const current = weatherData;
            const today = new Date();
            const month = today.getMonth();

            let crop = "Teff";
            let reason = "Optimal soil moisture and temperature for teff planting.";
            let window = "Now – 2 weeks";

            if (city.includes("Jimma") || city.includes("Bonga") || city.includes("Gambela") || city.includes("Metu")) {
                if (month >= 3 && month <= 6) {
                    crop = "Maize";
                    reason = "Heavy rains support maize growth in lowlands.";
                    window = "This week";
                } else if (month >= 9 && month <= 11) {
                    crop = "Coffee";
                    reason = "Dry season ideal for coffee flowering.";
                    window = "Not planting – monitor flowering";
                } else {
                    crop = "Enset";
                    reason = "Consistent moisture supports enset development.";
                    window = "Year-round (with compost)";
                }
            } else if (city.includes("Mekelle") || city.includes("Adigrat") || city.includes("Semera") || city.includes("Dire Dawa")) {
                crop = "Sorghum";
                reason = "Highly drought-tolerant; suitable for current dry conditions.";
                window = "Next 10 days";
            } else if (month >= 6 && month <= 8) {
                crop = "Teff or Wheat";
                reason = "Peak Kiremt rains – ideal for cereal planting.";
                window = "Now – 3 weeks";
            } else if (month >= 2 && month <= 4) {
                crop = "Barley or Chickpea";
                reason = "Short rains support cool-season crops.";
                window = "Now – 2 weeks";
            }

            return { crop, reason, window };
        }

        function updateRecommendations(city, weatherData) {
            document.getElementById('rec-city').textContent = city;
            document.getElementById('calendar-city').textContent = city;

            const rec = getRecommendation(city, weatherData);
            const cropCard = document.getElementById('recommended-crop');
            cropCard.innerHTML = `
                <h4>${rec.crop}</h4>
                <div class="crop-detail"><span class="label">Why:</span><span class="value">${rec.reason}</span></div>
                <div class="crop-detail"><span class="label">Planting Window:</span><span class="value">${rec.window}</span></div>
                <div class="crop-detail"><span class="label">Soil Match:</span><span class="value">✅ High</span></div>
            `;

            // Update calendar
            const calendarGrid = document.getElementById('planting-calendar');
            if (city.includes("Jimma") || city.includes("Gambela")) {
                calendarGrid.innerHTML = `
                    <div class="calendar-item">
                        <h5>Maize</h5>
                        <div class="window">Apr – Jul</div>
                    </div>
                    <div class="calendar-item">
                        <h5>Coffee</h5>
                        <div class="window">Sep – Nov</div>
                    </div>
                    <div class="calendar-item">
                        <h5>Enset</h5>
                        <div class="window">Year-round</div>
                    </div>
                `;
            } else if (city.includes("Mekelle") || city.includes("Semera")) {
                calendarGrid.innerHTML = `
                    <div class="calendar-item">
                        <h5>Sorghum</h5>
                        <div class="window">May – Aug</div>
                    </div>
                    <div class="calendar-item">
                        <h5>Sesame</h5>
                        <div class="window">Jun – Sep</div>
                    </div>
                `;
            } else {
                calendarGrid.innerHTML = `
                    <div class="calendar-item">
                        <h5>Maize</h5>
                        <div class="window">Jun – Sep</div>
                    </div>
                    <div class="calendar-item">
                        <h5>Teff</h5>
                        <div class="window">Jul – Oct</div>
                    </div>
                    <div class="calendar-item">
                        <h5>Wheat</h5>
                        <div class="window">Jul – Nov</div>
                    </div>
                    <div class="calendar-item">
                        <h5>Barley</h5>
                        <div class="window">Mar – May</div>
                    </div>
                `;
            }
        }

        // PDF Export Function
        async function exportToPDF() {
            const exportBtn = document.getElementById('exportBtnHero');
            const exportBtnRec = document.getElementById('exportBtnRec');
            exportBtn.disabled = true;
            exportBtnRec.disabled = true;
            exportBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
            exportBtnRec.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';

            try {
                // Get current city
                const activeCityBtn = document.querySelector('.city-btn.active');
                const city = activeCityBtn ? activeCityBtn.getAttribute('data-city') : 'Addis Ababa';

                // Update hidden PDF content
                document.getElementById('pdf-city').textContent = city;
                document.getElementById('pdf-timestamp').textContent = new Date().toLocaleString('en-ET', { timeZone: 'Africa/Addis_Ababa' });

                // Weather
                document.getElementById('pdf-temp').textContent = document.getElementById('temp').textContent;
                document.getElementById('pdf-humidity').textContent = document.getElementById('humidity').textContent;
                document.getElementById('pdf-conditions').textContent = document.getElementById('conditions').textContent;
                document.getElementById('pdf-wind').textContent = document.getElementById('wind').textContent;

                // Crop
                const cropCard = document.getElementById('recommended-crop');
                const cropTitle = cropCard.querySelector('h4')?.textContent || '--';
                const reasonEl = cropCard.querySelector('.crop-detail .value')?.textContent || '--';
                const windowEl = cropCard.querySelectorAll('.crop-detail .value')[1]?.textContent || '--';

                document.getElementById('pdf-crop').textContent = cropTitle;
                document.getElementById('pdf-reason').textContent = reasonEl;
                document.getElementById('pdf-window').textContent = windowEl;

                // Generate PDF
                const pdfContent = document.getElementById('pdf-content');
                const canvas = await html2canvas(pdfContent, {
                    scale: 2,
                    backgroundColor: '#ffffff'
                });
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 297; // A4 height in mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                pdf.save(`Finedatas_Farming_Report_${city.replace(/\s+/g, '_')}.pdf`);
            } catch (error) {
                console.error('PDF generation failed:', error);
                alert('Failed to generate PDF. Please try again.');
            } finally {
                exportBtn.disabled = false;
                exportBtnRec.disabled = false;
                exportBtn.innerHTML = '<i class="fas fa-file-pdf"></i> Export Report (PDF)';
                exportBtnRec.innerHTML = '<i class="fas fa-file-pdf"></i> Export This Report as PDF';
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {
            const cityButtons = document.querySelectorAll('.city-btn');
            const data = await fetchWeatherData();

            cityButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    cityButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    const city = btn.getAttribute('data-city');
                    updateWeatherDisplay(data, city);
                    const cityData = data.weather_data.find(item => item.location === city);
                    if (cityData) {
                        updateRecommendations(city, cityData.current);
                    }
                });
            });

            // Initial load
            updateWeatherDisplay(data, 'Addis Ababa');
            const initialCityData = data.weather_data.find(item => item.location === 'Addis Ababa');
            if (initialCityData) {
                updateRecommendations('Addis Ababa', initialCityData.current);
            }

            // Export buttons
            document.getElementById('exportBtnHero').addEventListener('click', exportToPDF);
            document.getElementById('exportBtnRec').addEventListener('click', exportToPDF);

            document.querySelector('.mobile-menu-btn').addEventListener('click', () => {
                document.querySelector('.nav-links').classList.toggle('active');
            });
        });
    </script>
</body>
</html>
